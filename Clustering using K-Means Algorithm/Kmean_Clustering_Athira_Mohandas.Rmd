---
title: "Clustering on European Protein Consumption"
author: "Athira"
date: "2025-05-25"
output: 
 html_document:
   toc: true
   toc_float: true
   number_sections: true
   always_allow_html: true
 pdf_document:
   toc: true
   number_sections: true
   latex_engine: xelatex
   df_print: paged
   includes:
      in_header: header.tex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Importing Libraries and load input files or European protein consumption dataset

```{r importing}
library(cluster)
  library(tidyverse)
  library(dplyr)
  library(ggplot2)
  library(factoextra)
#Load CSV data set and making a copy
  protein_1<-read.csv("protein.csv",fileEncoding = "latin1")
  protein_2<-protein_1

```

# PROGRAM FOR CLUSTERING REDMEAT and WHITEMEAT USING Kmean ALGORITHM AND PLOT USING DIFFERENT GRAPHS

```{r Kmean1}
#Select an object with the required fields for Kmeans
  red_white_meat<-protein_2 %>% select(RedMeat,WhiteMeat)
#For labeling get the country details in other variable
  Country<-protein_2$Country
#Calculate Kmean for the red_white_meat object(Redmeat and whitemeat) with 3 clusters and 25 iterations
  kmean.result <- kmeans(red_white_meat,3,25)
#Adding labels to cluster after making into factor datatype
  protein_2$Cluster_Meat <- as.factor(kmean.result$cluster)
```

## Plot RedMeat and Whitemeat Using ggplot with datapoints as 25 Countries with 3 clusters

```{r ggplotCluster, fig.width=10, fig.height=7}
ggplot(protein_2, aes(x = RedMeat, y = WhiteMeat, 
                      color = Cluster_Meat, label = Country)) +
                      geom_point(size = 3) +geom_text(vjust = -0.5, size = 5) +
                      labs(title = "K-Means Clustering (k = 3) on Red and White Meat",
                     x = "Red Meat Consumption", y = "White Meat Consumption") +
                     theme_minimal()
```

## Ploting same graph after normalizing using scale() option

```{r normalizedPlot,fig.width=10, fig.height=5.8}
#scaling the whitemeat and red meat protein values for getting normalized values
  cluster_colors<-c("Red","green","blue")
  red_white_meat_scaled<-red_white_meat %>%scale()
#Generating Kmeans with normalized values
  kmean.result <- kmeans(red_white_meat_scaled,3,25)
#plot a table to find similarity between countries and their redmeat and whitemeat consuption
  table(protein_2$Country,kmean.result$cluster)
#Plot the graph based on clusters, centroids and counties with RedMeat in x-axis and WhiteMeat in y-axis.
  plot(red_white_meat_scaled[,"RedMeat"],red_white_meat_scaled[,"WhiteMeat"],
       col=cluster_colors[kmean.result$cluster],xlim=c(-2,3),ylim = c(-2,2),
       xlab ="RedMeat",ylab = "WhiteMeat" )
  points(kmean.result$centers[,c("RedMeat", "WhiteMeat")], 
         pch = 8, cex=4,col=cluster_colors[1:3])
  text(kmean.result$centers, labels = paste("C", 1:3, sep=""), 
       pch=8, pos = 3, cex = 1,col = cluster_colors[1:3])
  text(red_white_meat_scaled[,"RedMeat"], red_white_meat_scaled[,"WhiteMeat"], 
       labels = Country,col = cluster_colors[kmean.result$cluster],pos = 4,cex = 1)

```

## Ploting the same graph using Fviz_cluster option

```{r}
#Generate the same plot with fviz_cluster, which shows boundaries for each cluster and centriods
  fviz_cluster(kmeans(red_white_meat,centers = 3,100),data=red_white_meat)
```

## Results inferred from above graph and table

 - RedMeat is plotted in X-axis and WhiteMeat in Y-axis
 - 25 countries are plotted into 3 clusters
 - C1 cluster[Sweden,Romania,Bulgaria,Yugoslavia,Italy,USSR,Norway,Finland, Greece,Albania,     Portugal,Spain], having low WhiteMeat and RedMeat consumption.
 - C2 cluster[Switzerland, France, Belgarium,UK, Finland] having high redMeat consumption and medium 
 WhiteMeat consuption.
 - c3 cluster[Austria,Netherlands,W Germany,Hungary,EGermany,Czechoslovakia,Denmark,Poland] 
low RedMeat and High WhiteMeat Consumption.

# PROGRAM FOR CLUSTERING 9 PROTEIN INTO 7 CLUSTERS USING KMeans

Normalize dataset contains 9 protein and clustured using Kmeans algorithm with 7 clusters
```{r Kmean2}
#Removing the Country names from data for analystical purpose
  protein_1$Country<-NULL
#Scaling or Normalizing the data
  protein_1_scaled<-protein_1 %>% scale()
#For the pupose of ploting generate an object with different colors
  cluster_colors<-c("Red","blue","green","brown","violet","black","purple")
#Apply kmeans algorithm on above scaled data
  kmean.result1<-kmeans(protein_1_scaled,7,100) 
```

## Generate a table with 25 countries and kmean clusters of 9 proteins

```{r}
#Plot a table to find relationship between European Countries and protein consumption
  table(protein_2$Country,kmean.result1$cluster)


```

## Plot the graph with Eggs in X-axis and Milk in Y-axis along with kmeans values generated from 9 protein data.

```{r warning=FALSE,fig.width=10, fig.height=7}
#piloting the graph with Eggs on X-axis and Milk on Y-axis and also influenced by all 9 protein consumption
#Created 7 clusters with countries as datapoints and each cluster having  centroids 
  plot(protein_1_scaled[,"Eggs"],protein_1_scaled[,"Milk"],col=cluster_colors[kmean.result1$cluster],xlim=c(-2.5,2),ylim =c(-2,2.8),ylab="Milk",xlab="Eggs")
  points(kmean.result1$centers[,c("Eggs", "Milk")], col = cluster_colors[1:7], pch = 8, cex=2,pos=3)
  text(kmean.result1$centers[,"Eggs"],kmean.result1$centers[,"Milk"]+.2,labels = paste("C", 1:7, sep=""),col=cluster_colors[1:7] ,cex = 1,pch=8)
  text(protein_1_scaled[,"Eggs"], protein_1_scaled[,"Milk"], 
     labels = Country, 
     pos = 3, cex = 1, col = cluster_colors[kmean.result1$cluster])
```

## Inference from above Plot
 
 - plot Eggs and Milk in X and y-axis.Also have the effect of 9 protein
 - for cluster C1[Portugal, Spain], having similar egg and mik consumption.
 - Cluster C2[Albania,Yugoslavia,Romania, Bulgaria,Hungary,USSR] having very low egg and milk consumption
 - Cluster c3[Czechoslovakia,Poland,E Germany,W Germany,Austria,Netherland,Poland]
milk and Egg medium consumption
 - Cluster C4[Finland,Denmark, Sweden,Norway] having high milk consumption and medium egg consumption
 - Cluster C5[Ireland,Belgium, UK] having high milk and egg consumption
 - Cluster C6[Greece, Italy] having low egg and milk consumption
 - Cluster C7[France, Switzerland] have more than medium egg and milk consumption
 
## ploting the graph with Fish on X-axis and Cereals on Y-axis and also influenced by all 9 protein consumption
  - Created 7 clusters with Countries as data points and each cluster having  centroids.
   
```{r FishCerealsPlot, fig.width=10, fig.height=7}
plot(protein_1_scaled[,"Fish"],protein_1_scaled[,"Cereals"],
     col=cluster_colors[kmean.result1$cluster],xlim=c(-1,3.5),
     ylim = c(-1.3,2.5),xlab = "Fish",ylab = "Cereals")
  points(kmean.result1$centers[,c("Fish", "Cereals")], col = cluster_colors[1:7],
         pch = 8, cex=2)
  text(protein_1_scaled[,"Fish"], protein_1_scaled[,"Cereals"], 
     labels = Country, 
     pos = 4, cex = 1, col = cluster_colors[kmean.result1$cluster])
  text(kmean.result1$centers[,"Fish"],kmean.result1$centers[,"Cereals"],
       labels = paste("C", 1:7, sep=""),col = cluster_colors[1:7],
       pos = 3, cex = 0.8)
```
   
## Inference from above Plot

 - Cluster C1[Spain and Portugal] having similar Fish and Cereal consumpton
 - Cluster C2[Bulgaria,Yugoslavia, Romania, Albania, Hungary,USSR] having low fish and high Cereals consumption
 - Cluster C3[Poland,Czechoslovakia, Austria, E Germany,W Germany,Netherlands] having low Fish and Cereals consumption
 - Cluster C4[Norway,Denmark, Sweden] having high Fish and low Cereals consumption.
 - Cluster C5[Belgium,Ireland, UK] having similarity and have low fish and Cereals Consumption.
 - Cluster C6[Greece,Italy] having medium fish and Cereal consumption.
 - Cluster C7[Switzerland,France] having comparitively low Fish and Cereals Consumption
 
## Ploting the graph with Starch on X-axis and Nuts on Y-axis and also influenced by all 9 protein consumption

  - Created 7 clusters with countries as data points and each cluster having  centroids 
 
 
```{r StarchNutsPlot,fig.width=10, fig.height=7}
plot(protein_1_scaled[,"Starch"],protein_1_scaled[,"Nuts"],col=cluster_colors[kmean.result1$cluster], xlim=c(-2,2.5), ylim=c(-1.5,2),xlab = "Starch",ylab = "Nuts")
  points(kmean.result1$centers[,c("Starch", "Nuts")], col = cluster_colors[1:7], pch = 8, cex=2)
  text(protein_1_scaled[,"Starch"],protein_1_scaled[,"Nuts"], 
     labels = protein_2$Country, 
     pos = 4, cex = 1, col = cluster_colors[kmean.result1$cluster])
  text(kmean.result1$centers[,"Starch"],kmean.result1$centers[,"Nuts"], labels = paste("C", 1:7, sep=""),col=cluster_colors[1:7], pos = 3, cex = 0.8)

```
 
## Inference From Plot

 - Cluster C1[Spain, Portugal] having more Starch and Nuts Consumption.
 - Cluster C2[Albania,Bulgaria,Yugoslaviya,Romania, Hungary,USSR] having low Nuts consumption but starch consumption is scattered around
 - Cluster C3[Poland,E Germany, W Germany,Netherland, Austria] having high starch and low Nuts consumption
 - Cluster C4[Norway,Sweden, Finland, Denmark] having medium starch and low Nuts consumption
 - Cluster C5[UK,Belgium, Ireland] having high starch and low Nuts consumption. Similar to C3 but other proteins are the effective factor
 - Cluster C6[Italy] having medium high Nuts and low Starch consumption.
 - Cluster C7[Switzerland, France] having medium low starch and Nuts consumption.


## Graph showing 9 protein consumption based on dimention

```{r fig.width=10, fig.height=7}
#Plot a graph with 9 protein consumption, x axis and y axis plot is based on Dimensions
  fviz_cluster(kmean.result1,data = protein_1_scaled,geom="point")
```
